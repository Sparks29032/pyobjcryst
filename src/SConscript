Import('env')

# This will build the intermediate objects required for the library
SConscript(["SConscript.cctbx", "SConscript.newmat", "SConscript.objcryst"])

# This retrieves the intermediate objects
newmatobjs = env["newmatobjs"]
cctbxobjs = env["cctbxobjs"]
objcrystobjs = env["objcrystobjs"]

# This builds the shared library
sl = env.SharedLibrary("objcryst", objcrystobjs + cctbxobjs + newmatobjs)

# FIXME - need a portable way to install library!!! It would be nice to put it
# with the extension files, but this requires RPATH (which is not portable)
# information that comes from the setup.py. Look into how openalea.deploy can
# help.
#env.InstallAs(source = sl[0], target = "$LIBDIR/%s"%sl[0])

# Put this in the environment
env["objcrystlib"] = sl
